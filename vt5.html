<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Valentine</title>
  <style>
    :root{
      --bg1:#ffe6ea;
      --bg2:#f5b2c1;
      --card:#ffffffcc;
      --text:#141414;
      --muted:#3b3b3b;
      --accent:#ff2f62;
      --accent2:#ff7aa0;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      min-height:100vh;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
      background:
        radial-gradient(900px 520px at 20% 10%, var(--bg1), transparent 60%),
        radial-gradient(900px 560px at 80% 90%, var(--bg2), transparent 58%),
        linear-gradient(135deg, #fff0f3 0%, #f2a7b5 100%);
      color:var(--text);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:24px;
      overflow:hidden;
    }

    .wrap{
      width:min(820px, 100%);
      perspective: 1200px;
    }
    .card{
      background:var(--card);
      backdrop-filter: blur(10px);
      border: 1px solid rgba(255,255,255,.55);
      border-radius: 22px;
      box-shadow: 0 26px 70px rgba(0,0,0,.16);
      padding: 26px;
      transform-style: preserve-3d;
      position:relative;
      overflow:hidden;
    }
    .card::before{
      content:"";
      position:absolute; inset:-40%;
      background: radial-gradient(circle at var(--mx,50%) var(--my,50%),
        rgba(255,255,255,.55), transparent 55%);
      opacity:.55;
      pointer-events:none;
      transform: translateZ(-20px);
    }

    .top{
      display:flex;
      gap:12px;
      justify-content:space-between;
      align-items:flex-start;
      transform: translateZ(18px);
    }
    .badge{
      background:rgba(255,255,255,.75);
      border: 1px solid rgba(0,0,0,.06);
      padding:7px 11px;
      border-radius:999px;
      font-size:13px;
      opacity:.9;
      white-space:nowrap;
    }

    h1{
      margin:0;
      font-size: clamp(26px, 3.6vw, 44px);
      letter-spacing:-.9px;
      transform: translateZ(24px);
    }
    p{
      margin:10px 0 0;
      color:var(--muted);
      opacity:.9;
      line-height:1.45;
      transform: translateZ(18px);
      font-size: clamp(14px, 2vw, 18px);
    }

    .progress{
      height: 10px;
      background: rgba(255,255,255,.65);
      border-radius:999px;
      overflow:hidden;
      margin: 16px 0 20px;
      transform: translateZ(12px);
    }
    .bar{
      height:100%;
      width:0%;
      border-radius:999px;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      transition: width .3s ease;
    }

    .question{
      margin: 8px 0 14px;
      font-size: clamp(18px, 2.6vw, 26px);
      line-height:1.25;
      transform: translateZ(22px);
    }

    .choices{
      display:grid;
      gap:12px;
      transform: translateZ(18px);
    }
    button{
      border:0;
      border-radius:16px;
      padding:14px 16px;
      font-size:16px;
      cursor:pointer;
      font-weight:700;
      transition: transform .08s ease, box-shadow .2s ease, filter .2s ease;
    }
    button:active{transform: scale(.985)}
    .btn{
      background:#fff;
      border: 1px solid rgba(0,0,0,.07);
      text-align:left;
      box-shadow: 0 10px 20px rgba(0,0,0,.06);
    }
    .btn:hover{filter:brightness(.99); box-shadow: 0 14px 26px rgba(0,0,0,.08);}

    .primary{
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      color:#fff;
      font-weight:900;
      box-shadow: 0 16px 36px rgba(255,47,98,.22);
      text-align:center;
    }

    /* ===== FINAL ASK (simple) ===== */
    .ask{
      display:flex;
      flex-direction:column;
      gap:18px;
      align-items:center;
      justify-content:center;
      min-height: 520px;
      position:relative;
      transform-style: preserve-3d;
    }
    .askTitle{
      margin:0;
      text-align:center;
      font-size: clamp(42px, 6vw, 76px);
      letter-spacing:-1.6px;
      line-height: .98;
      transform: translateZ(32px);
    }
    .askButtons{
      display:flex;
      gap:14px;
      flex-wrap:wrap;
      justify-content:center;
      width:100%;
      position:relative;
      z-index:4;
      min-height: 70px;
      transform: translateZ(22px);
    }
    .yes{ min-width: 220px; }
    .no{
      min-width: 220px;
      background:#fff;
      border: 1px solid rgba(0,0,0,.09);
      box-shadow: 0 12px 26px rgba(0,0,0,.08);
      position:absolute; /* on le fait bouger ici */
      z-index:10;
      left: 50%;
      transform: translateX(-50%);
      top: 0;
    }

    /* ===== Scene 3D (minimal et clean) ===== */
    .scene{
      width: min(700px, 100%);
      height: 320px;
      position:relative;
      perspective: 1200px;
      transform-style: preserve-3d;
      transform: translateZ(10px);
    }
    .rig{
      position:absolute; inset:0;
      transform-style: preserve-3d;
      animation: rig 7s ease-in-out infinite alternate;
      will-change: transform;
    }
    @keyframes rig{
      from{ transform: rotateX(10deg) rotateY(-14deg); }
      to{ transform: rotateX(-10deg) rotateY(16deg); }
    }

    .heart3d{
      position:absolute;
      left:50%; top:56%;
      width: 170px; height: 170px;
      transform: translate(-50%,-50%) translateZ(70px) rotateZ(45deg);
      transform-style: preserve-3d;
      filter: drop-shadow(0 28px 42px rgba(0,0,0,.18));
      animation: pulse 1.5s ease-in-out infinite;
    }
    @keyframes pulse{
      0%,100%{ transform: translate(-50%,-50%) translateZ(70px) rotateZ(45deg) scale(1); }
      50%{ transform: translate(-50%,-50%) translateZ(84px) rotateZ(45deg) scale(1.06); }
    }
    .heart3d .core{
      position:absolute; inset:0;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      border-radius: 20px;
      transform: translateZ(14px);
      box-shadow: inset 0 -18px 30px rgba(0,0,0,.12);
    }
    .heart3d .core::before,
    .heart3d .core::after{
      content:"";
      position:absolute;
      width: 170px; height: 170px;
      border-radius:999px;
      background: inherit;
    }
    .heart3d .core::before{ left:-85px; top:0; }
    .heart3d .core::after{ left:0; top:-85px; }
    .heart3d .depth{
      position:absolute; inset:0;
      border-radius:20px;
      background: linear-gradient(135deg, rgba(0,0,0,.08), rgba(0,0,0,.16));
      opacity:.42;
    }

    .flower{
      position:absolute;
      left: 18%;
      top: 60%;
      transform: translate(-50%,-50%) translateZ(52px);
      transform-style: preserve-3d;
      filter: drop-shadow(0 22px 34px rgba(0,0,0,.15));
      animation: floatA 3.6s ease-in-out infinite;
    }
    @keyframes floatA{
      0%,100%{ transform: translate(-50%,-50%) translateZ(52px) rotateZ(-6deg); }
      50%{ transform: translate(-50%,-56%) translateZ(68px) rotateZ(6deg); }
    }
    .flower .stem{
      position:absolute; left:50%; top:58px;
      width: 12px; height: 170px;
      transform: translateX(-50%) translateZ(10px);
      border-radius:999px;
      background: linear-gradient(180deg, #2fd07b, #0c8f4a);
    }
    .flower .head{
      position:absolute; left:50%; top:0;
      width: 140px; height: 140px;
      transform: translateX(-50%) translateZ(26px);
      transform-style: preserve-3d;
    }
    .flower .petal{
      position:absolute; left:50%; top:50%;
      width: 66px; height: 98px;
      border-radius:999px;
      transform-origin: center 82%;
      background: linear-gradient(135deg, #fff, #ffd1db);
      box-shadow: inset 0 -14px 20px rgba(0,0,0,.10);
    }
    .flower .petal:nth-child(1){ transform: translate(-50%,-50%) rotateZ(0deg) translateY(-28px); }
    .flower .petal:nth-child(2){ transform: translate(-50%,-50%) rotateZ(45deg) translateY(-28px); }
    .flower .petal:nth-child(3){ transform: translate(-50%,-50%) rotateZ(90deg) translateY(-28px); }
    .flower .petal:nth-child(4){ transform: translate(-50%,-50%) rotateZ(135deg) translateY(-28px); }
    .flower .petal:nth-child(5){ transform: translate(-50%,-50%) rotateZ(180deg) translateY(-28px); }
    .flower .petal:nth-child(6){ transform: translate(-50%,-50%) rotateZ(225deg) translateY(-28px); }
    .flower .petal:nth-child(7){ transform: translate(-50%,-50%) rotateZ(270deg) translateY(-28px); }
    .flower .petal:nth-child(8){ transform: translate(-50%,-50%) rotateZ(315deg) translateY(-28px); }
    .flower .center{
      position:absolute; left:50%; top:50%;
      width: 58px; height: 58px;
      transform: translate(-50%,-50%) translateZ(12px);
      border-radius:999px;
      background: radial-gradient(circle at 30% 30%, #fff6a6, #ffcc3a);
      box-shadow: inset 0 -12px 18px rgba(0,0,0,.14);
    }

    .choco{
      position:absolute;
      left: 84%;
      top: 64%;
      width: 190px; height: 130px;
      transform: translate(-50%,-50%) translateZ(44px) rotateZ(10deg);
      transform-style: preserve-3d;
      filter: drop-shadow(0 22px 34px rgba(0,0,0,.15));
      animation: floatB 3.9s ease-in-out infinite;
    }
    @keyframes floatB{
      0%,100%{ transform: translate(-50%,-50%) translateZ(44px) rotateZ(10deg); }
      50%{ transform: translate(-50%,-56%) translateZ(64px) rotateZ(-8deg); }
    }
    .choco .bar{
      position:absolute; inset:0;
      border-radius: 18px;
      background: linear-gradient(135deg, #4a2418, #8b4a2d);
      transform: translateZ(12px);
      box-shadow: inset 0 -20px 30px rgba(0,0,0,.22);
    }
    .choco .grid{
      position:absolute; inset:14px;
      display:grid;
      grid-template-columns: repeat(3, 1fr);
      gap:10px;
      transform: translateZ(20px);
    }
    .choco .sq{
      border-radius: 14px;
      background: linear-gradient(135deg, #5a2d1e, #a05a3b);
      box-shadow: inset 0 -10px 16px rgba(0,0,0,.22);
    }

    .toast{
      position:fixed;
      left:50%;
      bottom:18px;
      transform:translateX(-50%);
      background:#111;
      color:#fff;
      padding:10px 13px;
      border-radius:999px;
      font-size:14px;
      opacity:0;
      pointer-events:none;
      transition: opacity .25s ease, transform .25s ease;
      z-index:999;
    }
    .toast.show{
      opacity:1;
      transform:translateX(-50%) translateY(-6px);
    }
  </style>
</head>
<body>
  <div class="wrap" id="wrap">
    <div class="card" id="card">
      <div class="top">
        <div class="badge" id="step">Quiz</div>
        <div class="badge" id="score">Score: 0</div>
      </div>

      <h1 id="title">Hey Anna.</h1>
      <p id="subtitle">Hamza tâ€™a prÃ©parÃ© un mini quiz. Clique sur les rÃ©ponses, câ€™est tout.</p>

      <div class="progress"><div class="bar" id="bar"></div></div>

      <div class="question" id="question"></div>
      <div class="choices" id="choices"></div>
    </div>
  </div>

  <div class="toast" id="toast"></div>

  <script>
    // --- DonnÃ©es
    const quiz = [
      { q:"Quelle annÃ©e on sâ€™est rencontrÃ©s ?", a:["2022","2023","2024","2025"], ok:2 },
      { q:"La premiÃ¨re chose que je tâ€™ai offerte, câ€™Ã©taitâ€¦", a:["Un bouquet","Un bracelet","Une dame de cÅ“ur","Un parfum"], ok:2 },
      { q:"Notre date le plus insolite ?", a:["Bowling","Bar Ã  chats","Escape game","Aquarium"], ok:1 },
      { q:"Nos premiÃ¨res vacances ensemble :", a:["CrÃ¨te","Malte","Chypre","Sardaigne"], ok:2 },
      { q:"Comment sâ€™appellent mes parents ?", a:["IsmaÃ«l et Khadija","Smail et Khadija","Smail et Karima","Sofiane et Khadija"], ok:1 }
    ];

    // --- State
    let i = -1;
    let score = 0;

    // --- DOM
    const el = (id)=>document.getElementById(id);
    const card = el("card");
    const step = el("step");
    const scoreEl = el("score");
    const title = el("title");
    const subtitle = el("subtitle");
    const question = el("question");
    const choices = el("choices");
    const bar = el("bar");
    const toast = el("toast");

    function showToast(msg){
      toast.textContent = msg;
      toast.classList.add("show");
      setTimeout(()=>toast.classList.remove("show"), 1000);
    }

    function renderIntro(){
      step.textContent = "Quiz";
      scoreEl.textContent = "Score: 0";
      bar.style.width = "0%";
      title.textContent = "Hey Anna.";
      subtitle.textContent = "Hamza tâ€™a prÃ©parÃ© un mini quiz. Clique sur les rÃ©ponses, câ€™est tout.";
      question.textContent = "";
      choices.innerHTML = `<button class="primary" id="start">Commencer</button>`;
      el("start").onclick = ()=>{ i=0; renderQuestion(); };
    }

    function renderQuestion(){
      const item = quiz[i];
      step.textContent = `Question ${i+1}/5`;
      scoreEl.textContent = `Score: ${score}`;
      bar.style.width = `${(i/quiz.length)*100}%`;

      title.textContent = "Petit quiz";
      subtitle.textContent = "Une rÃ©ponse, un clic. Simple.";
      question.textContent = item.q;

      choices.innerHTML = "";
      item.a.forEach((txt, idx)=>{
        const b = document.createElement("button");
        b.className = "btn";
        b.textContent = txt;
        b.onclick = ()=>answer(idx);
        choices.appendChild(b);
      });
    }

    function answer(idx){
      const item = quiz[i];
      if(idx === item.ok){
        score++;
        showToast("âœ… Bien jouÃ©.");
      } else {
        showToast("ðŸ˜„ Presque.");
      }
      i++;
      if(i < quiz.length) renderQuestion();
      else renderAsk();
    }

    function renderAsk(){
      step.textContent = "Final";
      scoreEl.textContent = `Score: ${score}/5`;
      bar.style.width = "100%";

      title.textContent = "";
      subtitle.textContent = "";
      question.textContent = "";

      choices.innerHTML = `
        <div class="ask" id="ask">
          <div class="scene" aria-hidden="true">
            <div class="rig" id="rig">
              <div class="flower">
                <div class="head">
                  <span class="petal"></span><span class="petal"></span><span class="petal"></span><span class="petal"></span>
                  <span class="petal"></span><span class="petal"></span><span class="petal"></span><span class="petal"></span>
                  <div class="center"></div>
                </div>
                <div class="stem"></div>
              </div>

              <div class="choco">
                <div class="bar"></div>
                <div class="grid">
                  <div class="sq"></div><div class="sq"></div><div class="sq"></div>
                  <div class="sq"></div><div class="sq"></div><div class="sq"></div>
                </div>
              </div>

              <div class="heart3d">
                <div class="depth"></div>
                <div class="core"></div>
              </div>
            </div>
          </div>

          <h2 class="askTitle">VEUX-TU ÃŠTRE<br>MA VALENTINE ?</h2>

          <div class="askButtons" id="askButtons">
            <button class="primary yes" id="yes">OUI</button>
            <button class="no" id="no">NON</button>
          </div>
        </div>
      `;

      const ask = document.getElementById("ask");
      const rig = document.getElementById("rig");
      const yes = document.getElementById("yes");
      const no = document.getElementById("no");
      const askButtons = document.getElementById("askButtons");

      // placement initial du NON dans la zone des boutons
      function placeNo(){
        const r = askButtons.getBoundingClientRect();
        const pad = 8;
        const bw = no.offsetWidth || 220;
        const bh = no.offsetHeight || 54;

        const minX = pad;
        const maxX = Math.max(pad, r.width - bw - pad);
        const minY = 0;
        const maxY = Math.max(0, r.height - bh);

        no.style.left = `${minX + Math.random()*(maxX-minX)}px`;
        no.style.top  = `${minY + Math.random()*(maxY-minY)}px`;
      }

      function flee(){
        showToast("NON a pris peur.");
        placeNo();
      }

      requestAnimationFrame(placeNo);
      no.addEventListener("mouseenter", flee);
      no.addEventListener("click", flee);

      yes.onclick = ()=>{
        showToast("ðŸ’˜ OUI enregistrÃ©.");
        yes.textContent = "OUI ðŸ’˜";
        // petit boost
        rig.style.animationDuration = "5s";
      };

      // lÃ©ger parallax sur la scÃ¨ne (sobre)
      ask.addEventListener("mousemove", (e)=>{
        const rr = ask.getBoundingClientRect();
        const px = (e.clientX - rr.left)/rr.width;
        const py = (e.clientY - rr.top)/rr.height;
        const rx = (0.5 - py)*8;
        const ry = (px - 0.5)*10;
        rig.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
      });
      ask.addEventListener("mouseleave", ()=>{
        rig.style.transform = `rotateX(0deg) rotateY(0deg)`;
      });
    }

    // petit tilt global (clean)
    const wrap = document.getElementById("wrap");
    wrap.addEventListener("mousemove", (e)=>{
      const r = card.getBoundingClientRect();
      const px = (e.clientX - r.left)/r.width;
      const py = (e.clientY - r.top)/r.height;
      const rx = (0.5 - py)*8;
      const ry = (px - 0.5)*10;
      card.style.transform = `rotateX(${rx}deg) rotateY(${ry}deg)`;
      card.style.setProperty("--mx", `${px*100}%`);
      card.style.setProperty("--my", `${py*100}%`);
    });
    wrap.addEventListener("mouseleave", ()=>{
      card.style.transform = `rotateX(0deg) rotateY(0deg)`;
    });

    renderIntro();
  </script>
</body>
</html>
